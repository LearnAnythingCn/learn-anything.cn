{
    "componentChunkName": "component---src-templates-article-article-detail-gen-js",
    "path": "/pm2-node-js-change-restart",
    "result": {"data":{"strapiArticles":{"id":"Articles_163","title":"PM2用监控模式实时更新Node.js项目！","description":"监控目录下所有文件，只要有文件更新就立刻重启。","content":"##### 一、问题简介\n\n监控目录下所有文件，只要有文件更新就立刻重启。\n\n---\n\n##### 二、解决方案\n\n###### 1、`--watch`\n\n- 监控项目目录下所有文件，任意文件有改动，就自动重启 node.js 项目。\n\n  ```shell\n  # 1、安装 pm2\n    npm install pm2 @latest -g\n    # or\n    yarn global add pm2\n  \n  # 2、转到 node.js 项目根目录下\n    cd < 项目根目录 >\n  \n  # 3、用 pm2 启动 node.js 项目，项目目录下有文件改动就重启\n    pm2 start app.js--watch\n  \n  # 现在就可以正常访问 node.js 项目了，且可以查看项目状态\n    pm2 list\n    pm2 log\n  ```\n\n###### 2、`--ignore-watch`\n\n- 可以去除一些不需要监控的目录或文件。\n\n  ```shell\n  # 监控除了  node_modules 目录以外文件\n    pm2 start app.js --watch --ignore-watch=\"node_modules\"\n  ```\n\n###### 3、配置文件中设置监控的方法\n\n- 情况1：监控和忽略具体文件\n\n  ```js\n  module.exports = {\n      script: \"app.js\",\n      // 监控这两个文件夹\n      watch: [\"server\", \"client\"],\n      // 监控时间间隔\n      watch_delay: 1000,\n      // 忽略这两个文件夹\n      ignore_watch: [\"node_modules\", \"client/img\"],\n  }\n  ```\n\n- 情况2：监控项目目录下所有文件\n\n  ```js\n  module.exports = {\n      script: \"app.js\",\n      watch: true\n  }\n  ```\n\n---\n\n##### 三、restart 与 reload  区别\n\n- restart 会杀掉现有进程 并 启动新进程，服务会中断；\n\n- reload 不会杀掉现有进程，在现有进程重新加载，服务不会中断；\n\n  ```shell\n  # 只有 app_name 这个应用被reload\n    pm2 reload <app_name>\n  \t\n  # 配置文件中所有应用都被reload\n    pm2 reload process.json\n  \t\n  # 只有配置文件中的api应用被reload\n    pm2 reload process.json --only api\n  ```\n\n---\n\n##### 四、参考文档\n\n- [restart-strategies - 官方文档](https://pm2.keymetrics.io/docs/usage/restart-strategies/)\n\n\n","url":"https://learn-anything.cn/pm2-node-js-change-restart","author":null,"published_at":"2021-10-26T12:29:47.000Z","tags":[{"name":"PM2","slug":"pm2"}]},"site":{"siteMetadata":{"title":"收集优质资源","author":"@learn-anything.cn","description":"追求极简语言，说明事物因果！","email":"lh@learn-anything.cn"}}},"pageContext":{"title":"PM2用监控模式实时更新Node.js项目！","slug":"pm2-node-js-change-restart"}},
    "staticQueryHashes": ["63159454"]}