{
    "componentChunkName": "component---src-templates-article-article-detail-gen-js",
    "path": "/pm2-nodejs-logs",
    "result": {"data":{"strapiArticles":{"id":"Articles_170","title":"PM2实时查看Node.js项目的输出日志！","description":"查看pm2守护的nodejs进程的日志，怎么设置日志路径？怎么清除日志？设置日志文件大小及循环周期。","content":"##### 一、问题简介\n\n只要通过PM2 启动的Node.js项目，可以非常方便的查看其输出日志。\n\n---\n\n##### 二、解决方案\n\n###### 1、常用命令\n\n```shell\n# 显示所有应用的实时日志\n  pm2 logs\n\n# 显示 api 应用的日志\n  pm2 logs api\n\n# json格式显示所有应用的日志\n  pm2 logs --json\n\n# 显示1000行 big-api 的日志\n  pm2 logs big-api --lines 1000\n\t\n# 用仪表盘显示所有应用\n  pm2 monit\n```\n\n###### 2、让输出日志加上时间\n\n```shell\npm2 start app.js --time\npm2 restart app --time\n```\n\n###### 3、默认日志的路径\n\n```shell\nHOME/.pm2/logs\n```\n\n###### 4、查看日志命令的可用选项\n\n```shell\npm2 logs -h\n```\n\n###### 5、启动应用时，怎么初始化日志相关信息\n\n```shell\npm2 start app.js [OPTIONS]\n\n-l --log [path]              specify filepath to output both out and error logs\n-o --output <path>           specify out log file\n-e --error <path>            specify error log file\n--time                       prefix logs with standard formated timestamp\n--log-date-format <format>   prefix logs with custom formated timestamp\n--merge-logs                 适用 cluster mode\n```\n\n###### 6、cluster mode 中，让所有进程日志都写进同一个日志\n\n```shell\n# 命令启动，加上选项\n  pm2 start app.js -i max --merge-logs <具体日志文件>\n\n# 配置文件中，设置属性：\n  merge_logs: true\n```\n\n###### 7、不需要输出日志\n\n```js\nmodule.exports = {\n    apps: [{\n        name: 'Business News Watcher',\n        script: 'app.js',\n        instances: 1,\n        out_file: \"/dev/null\",\n        error_file: \"/dev/null\",\n        cron_restart: '0 0 * * *',\n        [...]\n    }]\n}\n```\n\n###### 8、清除日志\n\n```shell\n# 清除所有应用的日志\n  pm2 flush\n\n# 清除 api 应用的日志\n  pm2 flush <api>\n```\n\n###### 9、日志文件的大小，以及日志保存多久等功能需要额外插件支持：\n\n```\npm2 install pm2-logrotate\n```\n\n- [pm2-logrotate - 官方说明](https://github.com/keymetrics/pm2-logrotate)\n\n---\n\n##### 三、参考文档\n\n- [log-management - 官方文档](https://pm2.keymetrics.io/docs/usage/log-management/)\n\n\n","url":"https://learn-anything.cn/pm2-nodejs-logs","published_at":"2021-10-27T04:48:38.000Z","tags":[{"name":"PM2","slug":"pm2"}]},"site":{"siteMetadata":{"title":"收集优质资源","author":"@learn-anything.cn","description":"追求极简语言，说明事物因果！","email":"lh@learn-anything.cn"}}},"pageContext":{"title":"PM2实时查看Node.js项目的输出日志！","slug":"pm2-nodejs-logs"}},
    "staticQueryHashes": ["63159454"]}