{
    "componentChunkName": "component---src-templates-article-article-detail-gen-js",
    "path": "/pm2-nodejs-env",
    "result": {"data":{"strapiArticles":{"id":"Articles_164","title":"PM2用环境变量隔离Node.js项目的开发与生产环境！","description":"develop 和 production 运行的环境有很大差别，譬如两个环境下的数据库地址、用户名等都是不一样的，硬编码这些参数不是好的选择，通过环境变量可以很好解决。","content":"##### 一、问题简介\n\ndevelop 和 production 运行的环境有很大差别，譬如两个环境下的数据库地址、用户名等都是不一样的，硬编码这些参数不是好的选择，通过环境变量可以很好解决。\n\n---\n\n##### 二、解决方案\n\n###### 1、生成配置文件\n\n- `pm2 init simple`\n\n  ```js\n  // 生成默认配置文件：ecosystem.config.js\n  module.exports = {\n    apps : [{\n      name   : \"app1\",\n      script : \"./app.js\"\n    }]\n  }\n  ```\n\n###### 2、添加环境变量配置\n\n```js\n// ecosystem.config.js\nmodule.exports = {\n    apps: [{\n        name: \"app1\",\n        script: \"./app.js\",\n        env: {\n\t\t\t\t\t\t\"ip\": \"192.168.1.2\",\n            \"NODE_ENV\": \"development\"\n        },\n        env_production: {\n\t\t\t\t\t\t\"ip\": \"192.168.1.1\",\n            \"NODE_ENV\": \"production\",\n        }\n      \tenv_develop: {\n            \"ip\": \"192.168.1.2\",\n            \"NODE_ENV\": \"develop\",\n        }\n    }]\n}\n```\n\n###### 3、调用环境变量\n\n- `env`  默认环境变量，只要启动应用：`pm2 start ecosystem.config.js `，那么 ip 变量就会被传递给应用 app1\n- `env_production`  对应调用方式是：`pm2 start ecosystem.config.js --env production`\n- `env_develop`  对应调用方式是：`pm2 start ecosystem.config.js --env develop`\n- 规则是 ：配置文件中定义  `env_`  开头的属性，那么就用  `--env`  参数调用。\n\n###### 4、`--update-env`  :  更新环境变量\n\n```shell\nNODE_ENV=production pm2 restart web-interface --update-env\n```\n\n---\n\n##### 三、参考文档\n\n- [environment - 官方文档](https://pm2.keymetrics.io/docs/usage/environment/)\n\n\n","url":"https://learn-anything.cn/pm2-nodejs-env","published_at":"2021-10-26T12:30:42.000Z","tags":[{"name":"PM2","slug":"pm2"}]},"site":{"siteMetadata":{"title":"收集优质资源","author":"@learn-anything.cn","description":"追求极简语言，说明事物因果！","email":"lh@learn-anything.cn"}}},"pageContext":{"title":"PM2用环境变量隔离Node.js项目的开发与生产环境！","slug":"pm2-nodejs-env"}},
    "staticQueryHashes": ["63159454"]}