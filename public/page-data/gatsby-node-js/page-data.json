{
    "componentChunkName": "component---src-templates-article-article-detail-gen-js",
    "path": "/gatsby-node-js",
    "result": {"data":{"strapiArticles":{"id":"Articles_352","title":"gatsby-node.js有什么作用？","description":"可以在 gatsby  编译期间做一些自定义操作。譬如自动创建页面、输出编译期间的一些日志等。","content":"##### 一、gatsby-node.js 解决什么问题？\n\nGatsby 提供了很多 API，方便 网站开发者 和 plugin开发者 在编译期间做一些自定义操作。\n\n###### 1、有哪些 API？\n\n- [API - 官方说明文档](https://www.gatsbyjs.com/docs/reference/config-files/node-api-helpers/)\n\n###### 2、怎么用？\n\n- 在项目根目录找到 `gatsby-node.js` ，没有就新建一个，按照上面官方文档编写代码即可，此文件会在项目编译期间被调用。\n\n###### 3、使用场景：\n\n- 从数据源下载了很多份格式相同的数据，每一份数据都要创建一个页面，手动创建工作量非常大，此时调用 `createPages` 自动批量创建页面，是非常好的解决方案。譬如从 wordpress 、 strapi(cms)、很多markdown文档 ，这些数据源导入的数据。\n- 在编译期间下载数据到 GraphQL 中。\n- 编译期间的一些事件日志，方便查看编译进度等。\n\n---\n\n##### 二、APIs 说明\n\n###### 1、createPages\n\n- 使用实例：\n\n  在根目录找  `gatsby-node.js` 文件，没有就创建一个。下面是使用  `onPostBuild`、`createPages`  这两个API的简单例子。\n\n  ```js\n  const path = require(`path`)\n  // Log out information after a build is done\n  exports.onPostBuild = ({ reporter }) => {\n    reporter.info(`Your Gatsby site has been built!`)\n  }\n  // Create blog pages dynamically\n  exports.createPages = async ({ graphql, actions }) => {\n    const { createPage } = actions\n    const blogPostTemplate = path.resolve(`src/templates/blog-post.js`)\n    const result = await graphql(`\n      query {\n        allSamplePages {\n          edges {\n            node {\n              slug\n              title\n            }\n          }\n        }\n      }\n    `)\n    result.data.allSamplePages.edges.forEach(edge => {\n      createPage({\n        path: `${edge.node.slug}`,\n        component: blogPostTemplate,\n        context: {\n          title: edge.node.title,\n        },\n      })\n    })\n  }\n  ```\n\n- 异步操作\n\n  如果在 createPages 中异步操作，譬如读取文件、访问远程数据等，需要通过下面三种方式通知gatsby，否则会有问题。\n\n  ```js\n  // Async/await\n  exports.createPages = async () => {\n    // do async work\n    const result = await fetchExternalData()\n  }\n  // Promise API\n  exports.createPages = () => {\n    return new Promise((resolve, reject) => {\n      // do async work\n    })\n  }\n  // Callback API\n  exports.createPages = (_, pluginOptions, cb) => {\n    // do async work\n    cb()\n  }\n  ```\n\n---\n\n###### 2、其他待补充\n\n。。。。\n\n---\n\n##### 三、参考文档\n\n- [gatsby-node.js - 官方说明文档](https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/)\n- [Node API Helpers - API官方说明文档](https://www.gatsbyjs.com/docs/reference/config-files/node-api-helpers/)\n\n\n","url":"https://learn-anything.cn/gatsby-node-js","author":null,"published_at":"2021-11-11T02:24:26.000Z","tags":[{"name":"Gatsby","slug":"gatsby"}]},"site":{"siteMetadata":{"title":"收集优质资源","author":"@learn-anything.cn","description":"追求极简语言，说明事物因果！","email":"lh@learn-anything.cn"}}},"pageContext":{"title":"gatsby-node.js有什么作用？","slug":"gatsby-node-js"}},
    "staticQueryHashes": ["63159454"]}