{
    "componentChunkName": "component---src-templates-article-article-detail-gen-js",
    "path": "/csrf-defense",
    "result": {"data":{"strapiArticles":{"id":"Articles_405","title":"怎么防止跨站请求伪造攻击（CSRF）？","description":"跨站请求伪造（英语：Cross-site request forgery），也被称为 one-click attack 或者 session riding，通常缩写为 CSRF 或者 XSRF， 是一种挟制用户在当前已登录的Web应用程序上执行非本意的操作的攻击方法。","content":"##### 一、CSRF 是什么？\n\n跨站请求伪造（英语：Cross-site request forgery），也被称为 one-click attack 或者 session riding，通常缩写为 CSRF 或者 XSRF， 是一种挟制用户在当前已登录的Web应用程序上执行非本意的操作的攻击方法。\n\n---\n\n##### 二、实际攻击场景\n\n下面用一个银行网站的转账功能，说明攻击原理。备注：涉及到 URL 等信息都是虚构。\n\n###### 1、登录账号\n\n- 正常登录了一家银行网站，查看其后台信息后，没有退出登录；\n\n- 假设这家银行操作转账的  URL  是：\n\n  ````\n  https://bank.example.com/withdraw?account=AccoutName&amount=1000&for=PayeeName\n  ````\n\n---\n\n###### 2、恶意链接\n\n- 此时你看到其他网站的一个诱导链接，你下意识点开了；\n\n- 诱导链接中包含恶意代码（用 转账链接 替代 真实图片链接）\n\n  ```\n  <img src=\"https://bank.example.com/withdraw?account=Alice&amount=1000&for=Badman\" />\n  ```\n\n---\n\n###### 3、攻击完成\n\n- 点击链接后，浏览器会打开 `<img>` 中  src  属性的链接来加载图片，但实际上执行了转账操作；\n- 转账请求所用电脑、浏览器、ip等环境跟登录账号时的环境一模一样，银行网站后台会认为这就是你本人在操作，所以验证通过，直接转账。\n\n---\n\n##### 三、防止 CSRF 攻击\n\n服务器端对请求做一次身份验证，拒绝掉无法通过验证的请求，即可方式 CSRF 攻击。\n\n###### 1、第一种方法：验证码\n\n给手机发送数字验证码、图形化验证码让客户识别、让用户再次输入账号密码等进行再次身份验证。\n\n---\n\n###### 2、第二种方法：Token\n\n- Token 使用过程：\n\n  ```\n  1、服务器生成一个 CSRF token；\n  2、客户端(浏览器) 提交表单中含有 CSRF token 信息；\n  3、服务端接收 CSRF token 并验证其有效性。\n  ```\n\n- 原理说明：\n\n  攻击者有可能在上面客户端中拿到 CSRF token，但是攻击者只能使用 JavaScript 来发起请求，如果服务器不支持  CORS(跨域资源)，那么攻击者的 `跨域 JavaScript 请求` 是会被服务器拒绝，达到防止 CSRF 攻击目的。\n\n- Node.js 项目中推荐使用  `csurf`  ，[具体使用方法，看这里！](https://www.npmjs.com/package/csurf#example)\n\n---\n\n##### 四、参考文档\n\n- [跨站请求攻击](https://www.wikiwand.com/zh-cn/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0)\n\n- [如何防止CSRF攻击？](https://tech.meituan.com/2018/10/11/fe-security-csrf.html)\n\n- [csurf - npm](https://www.npmjs.com/package/csurf)\n\n- [csurf - github](https://github.com/expressjs/csurf)\n\n\n","url":"https://learn-anything.cn/csrf-defense","author":null,"published_at":"2021-11-23T23:49:46.000Z","tags":[{"name":"JavaScript","slug":"java-script"},{"name":"网络安全","slug":"network-security"}]},"site":{"siteMetadata":{"title":"收集优质资源","author":"@learn-anything.cn","description":"追求极简语言，说明事物因果！","email":"lh@learn-anything.cn"}}},"pageContext":{"title":"怎么防止跨站请求伪造攻击（CSRF）？","slug":"csrf-defense"}},
    "staticQueryHashes": ["63159454"]}